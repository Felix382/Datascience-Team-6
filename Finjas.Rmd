---
title: "R Notebook"
output: html_notebook
---
---
title: "R Notebook"
output: html_notebook
---


```{r}
library(readr)
library(lubridate)
library(ggplot2)
library(dplyr)
library(readxl)

umsatzdaten <- read_csv("data/umsatzdaten_gekuerzt.csv")
kiwo<- read_csv("data/kiwo.csv")

merger<-left_join(umsatzdaten,kiwo)
#View (merger)

Zeiten <- read_excel("Zeiten.xlsx")
#View(Zeiten)

Zeiten <- Zeiten %>% 
mutate(Datum = as.Date(Datum)) 

merger <- merger %>% 
mutate(Datum = as.Date(Datum)) 



merger2<-left_join(merger,Zeiten, by='Datum')
View(merger2)

merger2[is.na(merger2)]<-0

merger2$wochentag <- weekdays(merger2$Datum)
View(merger2)

#View(merger2)


feiertage <- read_csv("data/feiertage.csv")


#View(feiertage)


merger3<-left_join(merger2,feiertage)
View(merger3)

merger3[is.na(merger3)]<-0

View(merger3)


```


```{r}

wetter <- read_csv("data/wetter.csv")
#View(wetter)

final<-left_join(merger3,wetter)

View(final)


#Relevant: Temperatur, Bewölkung
#Irrelevant: Windgeschwindigkeit, Wettercode zu viele NAs

#Monatsdurchschnittstemperatur

#Dummy for month and then average of the month, but the years cross
#seven days before and after the observation, dont know the code


```


```{r}

#Dummy für Wochentage, Stena Line fährt jeden Tag

final%>%
mutate(Dummy = ifelse(wochentag=='Dienstag', "1", "0"))


library (pracma)

movavg(wetter$Temperatur, 7, type=c("s"))



```